<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MÃ³dulo de Usuarios y Roles</title>
  <link rel="icon" href="../../favicon.ico" />

  <!-- Estilos comunes -->
  <link rel="stylesheet" href="../css/styles-base.css" />

  <!-- Estilos especÃ­ficos del mÃ³dulo -->
  <link rel="stylesheet" href="../css/usuarios.css" />
</head>
<body>
  <main class="usuarios-container">
    <img src="../assets/logo.png" alt="Logo del sistema" class="logo" />
    <h1>ğŸ‘¤ MÃ³dulo de Usuarios y Roles</h1>

    <!-- Crear usuario -->
    <section id="crear-usuario">
      <h2>â• Crear usuario</h2>
      <form>
        <label for="nombre">Nombre</label>
        <input type="text" id="nombre" placeholder="Nombre completo" />

        <label for="correo">Correo</label>
        <input type="email" id="correo" placeholder="correo@dominio.com" />

        <label for="rol">Rol</label>
        <select id="rol">
          <option value="super_admin">super_admin</option>
          <option value="admin">admin</option>
          <option value="gerente">gerente</option>
          <option value="dependiente">dependiente</option>
          <option value="cliente">cliente</option>
          <option value="cocina">cocina</option>
          <option value="repartidor">repartidor</option>
        </select>

        <button id="btnCrearUsuario">Crear usuario</button>
      </form>
      <p id="mensaje-crear" class="success" style="display:none;">Usuario creado correctamente âœ…</p>
    </section>

    <!-- Asignar permisos -->
    <section id="asignar-permisos">
      <h2>ğŸ”‘ Asignar permisos a rol</h2>
      <form>
        <label for="rol-permiso">Rol</label>
        <select id="rol-permiso"></select>

        <label for="permiso">Permiso</label>
        <select id="permiso"></select>

        <button id="btnAsignarPermiso">Asignar permiso</button>
      </form>
      <p id="mensaje-permiso" class="success" style="display:none;">Permiso asignado correctamente âœ…</p>
    </section>

    <!-- Probar permiso -->
    <section id="probar-permiso">
      <h2>ğŸ§ª Probar permiso</h2>
      <form>
        <label for="tpUsuarioId">UUID usuario</label>
        <input type="text" id="tpUsuarioId" placeholder="uuid del usuario" />

        <label for="tpPermiso">Permiso</label>
        <input type="text" id="tpPermiso" placeholder="ej: ver_pedidos" />

        <button id="btnProbarPermiso">Probar</button>
      </form>
      <p id="tpResultado">Resultado pendiente</p>
    </section>

    <!-- Inventario -->
    <section id="inventario">
      <h2>ğŸ“‹ Inventario</h2>
      <button id="btnReloadInventory">Recargar</button>
      <h3>Permisos</h3>
      <ul id="lista-permisos"></ul>
      <h3>Roles â†’ Permisos</h3>
      <ul id="lista-roles"></ul>
    </section>

    <!-- Listado de usuarios -->
    <section id="lista-usuarios">
      <h2>ğŸ‘¥ Usuarios registrados</h2>
      <table>
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Correo</th>
            <th>Rol</th>
            <th>Activo</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody id="usuarios-body"></tbody>
      </table>
    </section>

    <!-- Logs -->
    <section id="logs">
      <h2>ğŸ“ Logs</h2>
      <button id="btnClearLogs">Limpiar</button>
      <div id="log" class="log"></div>
    </section>
  </main>

  <!-- Modal editar usuario -->
  <div id="modal-editar" class="modal" style="display:none;">
    <div class="modal-content">
      <h3>Editar usuario</h3>
      <form>
        <label for="edit-nombre">Nombre</label>
        <input type="text" id="edit-nombre" />

        <label for="edit-correo">Correo</label>
        <input type="email" id="edit-correo" />

        <label for="edit-rol">Rol</label>
        <select id="edit-rol">
          <option value="super_admin">super_admin</option>
          <option value="admin">admin</option>
          <option value="gerente">gerente</option>
          <option value="dependiente">dependiente</option>
          <option value="cliente">cliente</option>
          <option value="cocina">cocina</option>
          <option value="repartidor">repartidor</option>
        </select>

        <label for="edit-activo">Activo</label>
        <select id="edit-activo">
          <option value="true">SÃ­</option>
          <option value="false">No</option>
        </select>

        <button id="btnGuardarCambios">Guardar cambios</button>
        <button id="btnCerrarModal">Cancelar</button>
      </form>
    </div>
  </div>

  <!-- Modal confirmaciÃ³n eliminaciÃ³n -->
  <div id="modal-confirmar" class="modal" style="display:none;">
    <div class="modal-content">
      <h3>Confirmar eliminaciÃ³n</h3>
      <p>Â¿EstÃ¡s seguro de que deseas eliminar este usuario?</p>
      <div class="modal-actions">
        <button id="btnConfirmarEliminar">ğŸ—‘ï¸ SÃ­, eliminar</button>
        <button id="btnCancelarEliminar" class="btn-secundario">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Supabase -->
  <script src="https://unpkg.com/@supabase/supabase-js@2.45.4/dist/umd/supabase.js"></script>
  <!-- Script del mÃ³dulo -->
  <script type="module" src="../js/usuarios.js"></script>
</body>
</html>
